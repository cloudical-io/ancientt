version: '0'
runner:
  #name: mock
  name: kubernetes
  kubernetes:
    kubeconfig: /home/atrost/.kube/config
    image: quay.io/galexrt/container-toolbox
    namespace: acntt
tests:
- type: iperf3
  outputs:
  - name: csv
    csv:
      filePath: /tmp/
      namePattern: 'acntt-{{ .PlannedTime }}-{{ .Data.Tester }}-{{ .Data.ServerHost }}_{{ .Data.ClientHost }}.csv'
#  - name: gochart
#    goChart:
#      types:
#        - single_axis
#      filePath: /tmp
#      namePattern: 'acntt-{{ .PlannedTime }}-{{ .Data.Tester }}-{{ .Data.ServerHost }}_{{ .Data.ClientHost }}-{{ .Extra.Type }}.csv'
  runOptions:
    rounds: 2
    # wait 10 seconds between each round
    interval: 10s
    mode: "sequential"
    parallelcount: 1
  # This hosts section would cause iperf3 to be run from all hosts to the hosts selected in the `destinations` section
  # Each entry will be merged into one list
  hosts:
    clients:
    #- name: all-hosts
    #  all: true
    - name: one-randomly-selected-server
      random: true
      count: 1
    #- name: all-hosts
    #  all: true
      #hosts:
      #  - servers-0
      #  - servers-4
    servers:
    - name: one-randomly-selected-server
      random: true
      count: 1
    #- name: different-hosts-1
    #  random: true
    #  count: 2 # when more than one hosts is wanted,
    #  hostSelector: # For Labels in K8s and Variables of hosts in Ansible
    #    network-tests-run-here: "true"
    #  antiAffinity:
    #    - key: "openstack-region" # this makes sure hosts with different "openstack-region" are picked
    #- name: specific-hosts
    #  hosts:
    #    - serverabc123
    #    - serverxyz789
  iperf3:
    udp: false
    additionalFlags:
      clients: []
      server: []
#- type: siege
#  runOptions:
#    rounds: 5
#    interval: 15m
#  siege: {}
